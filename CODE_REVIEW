
  5. N+1 Query Problem in Search

  Location: internal/maestro/flows/search_business.go:42-110
  Problem: For each business unit, makes separate API calls for
  schedules and bookings
  Impact: Searching 5 businesses = hundreds of API calls, massive
  performance hit
  Fix: Implement batch fetching or aggregation pipeline

  ðŸŸ  HIGH SEVERITY

  ðŸŸ¡ MEDIUM SEVERITY

  15. Context Leak in withTimeout

  Location: All repositories (lines 56-76)
  Problem: Creates new timeout context even when parent has shorter
   deadline
  Impact: Memory/goroutine leaks
  Fix: Check parent deadline and reuse if shorter

  16. Typo in Error Field Name

  Location: internal/bookings/validator/booking.go:121
  Problem: Field: "StratTime" should be "StartTime"
  Impact: Confusing error messages
  Fix: Fix typo

  17. Phone Regex Allows Empty String

  Location: internal/bookings/validator/booking.go:16
  Problem: ^(?:|\+[1-9]\d{7,14})$ matches empty strings
  Impact: Empty phone numbers pass validation
  Fix: Remove empty alternative: ^\+[1-9]\d{7,14}$

  18. Infinite Pagination Risk

  Location: internal/businessunits/service/business_unit.go:491-520
  Problem: No max iteration limit in pagination loop
  Impact: Potential infinite loop if total count is broken
  Fix: Add max iteration counter

  19. Idempotency Middleware Goroutine Leak

  Location: pkg/middleware/idempotency.go:68-86
  Problem: Cleanup goroutine runs indefinitely, leaks on store
  recreation
  Impact: Goroutine/memory leak over time
  Fix: Implement Stop() method and call on cleanup

  20. Missing End Time Parse Error in Create Booking

  Location: internal/maestro/flows/create_booking.go:42-48
  Problem: Failed end_time parse is silently ignored (sets
  endTimeProvided = false)
  Impact: User's intended duration ignored without error
  Fix: Return error if end_time provided but invalid